glimpse(hflights)
suppressMessages(library(dplyr))
library(hflights)
hflights <- tbl_df(hflights)
glimpse(hflights)
lut <- c("AA" = "American", "AS" = "Alaska", "B6" = "JetBlue", "CO" = "Continental", "DL" = "Delta", "OO" = "SkyWest", "UA" = "United", "US" = "US_Airways", "WN" = "Southwest", "EV" = "Atlantic_Southeast", "F9" = "Frontier", "FL" = "AirTran", "MQ" = "American_Eagle", "XE" = "ExpressJet", "YV" = "Mesa")
hflights$UniqueCarrier <- lut[hflights$UniqueCarrier]
glimpse(hflights)
lut <- c("A" = "carrier", "B" = "weather", "C" = "FFA", "D" = "security", "" = "not cancelled")
lut <- c("A" = "carrier", "B" = "weather", "C" = "FFA", "D" = "security", " " = "not cancelled")
hflights$CancellationCode <- lut[hflights$CancellationCode]
glimpse(hflights)
data(hflights)
glimpse(hflights)
unique(hflights$CancellationCode)
flights[, c("DepTime", "ArrTime", "FlightNum")]
flights <- tbl_df(hflights)
filter(flights, UniqueCarrier=="AA" | UniqueCarrier=="UA")
filter(flights, UniqueCarrier=="AA" | UniqueCarrier=="UA")
filter(flights, UniqueCarrier %in% c("AA", "UA"))
gimpse(filter(flights, UniqueCarrier %in% c("AA", "UA")))
glimpse(filter(flights, UniqueCarrier %in% c("AA", "UA")))
filter(select(flights, UniqueCarrier, DepDelay), DepDelay > 60)
flights %>%
select(UniqueCarrier, DepDelay) %>%
filter(DepDelay > 60)
select(flights, Year:DayofMonth, contains("Taxi"), contains("Delay"))
flights %>% group_by(UniqueCarrier)
flights %>%
select(UniqueCarrier) %>%
summarize(UniqueCarrier)
flights %>%
group_by(UniqueCarrier) %>%
summarise(flight_count = n())
flights %>%
group_by(CancellationCode) %>%
summarise(flight_count = n())
flights %>%
group_by(CancellationCode) %>%
summarise(flight_count = n()) %>%
arrange(desc(flight_count))
flights %>%
group_by(CancellationCode) %>%
summarise(flight_count = n()) %>%
arrange(desc(flight_count))
setwd("~/Documents/data science/data incubator")
setwd("~/Documents/datascience/dataincubator/crime_compare")
setwd("~/Documents/datascience/dataincubator/solar")
library(readr)
solar <- read_csv("00000-2.csv")
setwd("~/Documents/datascience/dataincubator/crime_compare")
library(readr)
library(dplyr)
library(lubridate)
library(ggplot2)
library(reshape2)
# reading data bases
washingtonDC_2013 <- read_csv("crime_washingtonDC_2013.csv")
chicago <- read_csv("crime_chicago.csv")
#######################################
# cleaning date_time format
washingtonDC_2013$REPORTDATETIME <- mdy_hms(washingtonDC_2013$REPORTDATETIME)
chicago$Date <- mdy_hms(chicago$Date)
# create chicago data base for year 2013
chicago_2013 <- chicago %>%
mutate(Year = year(Date)) %>%
filter(Year == 2013)
# factorize
washingtonDC_2013$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2013$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2013$METHOD <- factor(washingtonDC_2013$METHOD)
chicago_2013$`Primary Type` <- factor(chicago_2013$`Primary Type`)
chicago_2013$Arrest <- factor(chicago_2013$Arrest)
chicago_2013$Domestic <- factor(chicago_2013$Domestic)
# keeping offenses similar across both data bases
chicago_2013.clean <- chicago_2013 %>%
filter(`Primary Type` == "ARSON" |
`Primary Type` == "ASSAULT" |
`Primary Type` == "BATTERY" |
`Primary Type` == "BURGLARY" |
`Primary Type` == "CRIM SEXUAL ASSAULT" |
`Primary Type` == "HOMICIDE" |
`Primary Type` == "MOTOR VEHICLE THEFT" |
`Primary Type` == "ROBBERY" |
`Primary Type` == "SEX OFFENSE" |
`Primary Type` == "THEFT") %>%
mutate(OFFENSE = factor(`Primary Type`))
chicago <- chicago_2013.clean
washington <- washingtonDC_2013
# settling discrepancies between offense classification
# for Chicago - combining "assault" and "battery" into "assault", "sex assault" and "sex offense" into "sex abuse"
# for Washington - combining "theft f/auto" and "theft/other" into "theft"
levels(chicago$OFFENSE) <- c("ARSON","ASSAULT","ASSAULT","BURGLARY","SEX ABUSE","HOMICIDE","MOTOR VEHICLE THEFT","ROBBERY","SEX ABUSE","THEFT")
levels(washington$OFFENSE) <- c("ARSON","ASSAULT","BURGLARY","HOMICIDE","MOTOR VEHICLE THEFT","ROBBERY","SEX ABUSE","THEFT","THEFT")
offense.chicago <- chicago %>%
select(OFFENSE) %>%
count(OFFENSE, sort = T) %>%
mutate(offense.percent = round((n / nrow(chicago)*100),1))
offense.washington <- washington %>%
select(OFFENSE) %>%
count(OFFENSE, sort = T) %>%
mutate(offense.percent = round((n / nrow(washington)*100),1))
joined.offense <- left_join(offense.chicago,offense.washington,by = "OFFENSE") %>%
rename(n.chicago = n.x, n.washington = n.y, chicago = offense.percent.x, washington = offense.percent.y)
joined.offense.m <- melt(joined.offense,id.vars=c("OFFENSE","n.chicago","n.washington")) %>%
arrange(desc(value))
offense.barplot <- qplot(x=OFFENSE, y=value, fill=variable,
data=joined.offense.m, geom="bar", stat="identity",
position="dodge",ylab="%",main="Crime in cities of Chicago and Washington DC: Offense type")
names(joined.offense.m)
offense.barplot
head(joined.offense.m)
head(offense.washington)
offense.washington
washingtonDC_2012 <- read_csv("crime_incidents_2011_CSV.csv")
washingtonDC_2011 <- read_csv("crime_incidents_2011_CSV.csv")
names()
names(washingtonDC_2011)
washingtonDC_2013 <- read_csv("crime_washingtonDC_2013.csv")
names(washingtonDC_2013)
washingtonDC_2011$REPORTDATETIME <- mdy_hms(washingtonDC_2011$REPORTDATETIME)
washingtonDC_2012 <- read_csv("crime_incidents_2012_CSV.csv")
problems?
?problems
problems(washingtonDC_2013)
washingtonDC_2012$REPORTDATETIME <- mdy_hms(washingtonDC_2012$REPORTDATETIME)
dim(washingtonDC_2012)
dim(washingtonDC_2011)
dim(washingtonDC_2013)
washingtonDC_2012$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2012$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2012$METHOD <- factor(washingtonDC_2013$METHOD)
washingtonDC_2011$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2011$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2011$METHOD <- factor(washingtonDC_2013$METHOD)
washingtonDC_2013$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2013$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2013$METHOD <- factor(washingtonDC_2013$METHOD)
washingtonDC_2012$SHIFT <- factor(washingtonDC_2012$SHIFT)
washingtonDC_2012$OFFENSE <- factor(washingtonDC_2012$OFFENSE)
washingtonDC_2012$METHOD <- factor(washingtonDC_2012$METHOD)
washingtonDC_2011$SHIFT <- factor(washingtonDC_2011$SHIFT)
washingtonDC_2011$OFFENSE <- factor(washingtonDC_2011$OFFENSE)
washingtonDC_2011$METHOD <- factor(washingtonDC_2011$METHOD)
str(washingtonDC_2011)
chicago_2013 <- chicago %>%
mutate(Year = year(Date)) %>%
filter(Year >= 2011 & Year <= 2013)
chicago_2013 <- chicago %>%
mutate(Year = year(Date)) %>%
filter(Year == 2013)
chicago_2011_to_2013 <- chicago %>%
mutate(Year = year(Date)) %>%
filter(Year >= 2011 & Year <= 2013)
glimpse(chicago_2011_to_2013)
chicago_2011_to_2013$`Primary Type` <- factor(chicago_2013$`Primary Type`)
chicago_2011_to_2013$Arrest <- factor(chicago_2013$Arrest)
chicago_2011_to_2013$Domestic <- factor(chicago_2013$Domestic)
chicago_2011_to_2013.clean <- chicago_2011_to_2013 %>%
filter(`Primary Type` == "ARSON" |
`Primary Type` == "ASSAULT" |
`Primary Type` == "BATTERY" |
`Primary Type` == "BURGLARY" |
`Primary Type` == "CRIM SEXUAL ASSAULT" |
`Primary Type` == "HOMICIDE" |
`Primary Type` == "MOTOR VEHICLE THEFT" |
`Primary Type` == "ROBBERY" |
`Primary Type` == "SEX OFFENSE" |
`Primary Type` == "THEFT") %>%
mutate(OFFENSE = factor(`Primary Type`))
?rbind
test <- rbind(washingtonDC_2013, washingtonDC_2012)
dim(test)
tail(test)
year <- year(test$REPORTDATETIME)
washingtonDC_2011$REPORTDATETIME
test$REPORTDATETIME
head(test$REPORTDATETIME)
tail(test$REPORTDATETIME)
washingtonDC_2012$REPORTDATETIME <- mdy_hms(washingtonDC_2012$REPORTDATETIME)
washingtonDC_2011$REPORTDATETIME <- mdy_hms(washingtonDC_2011$REPORTDATETIME)
head(washingtonDC_2012$REPORTDATETIME)
head(washingtonDC_2012)
head(washingtonDC_2012$START_DATE)
head(washingtonDC_2011$REPORTDATETIME)
head(test)
tail(test)
washington <- rbind(washingtonDC_2013, washingtonDC_2012, washingtonDC_2011)
dim(washington)
rows(washington)
dim(washington)[1]
dim(washingtonDC_2011)[1] + dim(washingtonDC_2012)[1] + dim(washingtonDC_2013)[1]
chicago_2011_to_2013.clean <- chicago_2011_to_2013 %>%
filter(`Primary Type` == "ARSON" |
`Primary Type` == "ASSAULT" |
`Primary Type` == "BATTERY" |
`Primary Type` == "BURGLARY" |
`Primary Type` == "CRIM SEXUAL ASSAULT" |
`Primary Type` == "HOMICIDE" |
`Primary Type` == "MOTOR VEHICLE THEFT" |
`Primary Type` == "ROBBERY" |
`Primary Type` == "SEX OFFENSE" |
`Primary Type` == "THEFT") %>%
mutate(OFFENSE = factor(`Primary Type`))
levels(chicago$OFFENSE) <- c("ARSON","ASSAULT","ASSAULT","BURGLARY","SEX ABUSE","HOMICIDE","MOTOR VEHICLE THEFT","ROBBERY","SEX ABUSE","THEFT")
levels(washington$OFFENSE) <- c("ARSON","ASSAULT","BURGLARY","HOMICIDE","MOTOR VEHICLE THEFT","ROBBERY","SEX ABUSE","THEFT","THEFT")
offense.chicago <- chicago %>%
select(OFFENSE) %>%
count(OFFENSE, sort = T) %>%
mutate(offense.percent = round((n / nrow(chicago)*100),1))
offense.washington <- washington %>%
select(OFFENSE) %>%
count(OFFENSE, sort = T) %>%
mutate(offense.percent = round((n / nrow(washington)*100),1))
offense.washington
joined.offense <- left_join(offense.chicago,offense.washington,by = "OFFENSE") %>%
rename(n.chicago = n.x, n.washington = n.y, chicago = offense.percent.x, washington = offense.percent.y)
joined.offense.m <- melt(joined.offense,id.vars=c("OFFENSE","n.chicago","n.washington")) %>%
arrange(desc(value))
offense.barplot <- qplot(x=OFFENSE, y=value, fill=variable,
data=joined.offense.m, geom="bar", stat="identity",
position="dodge",ylab="%",main="Crime in cities of Chicago and Washington DC: Offense type")
offense.barplot
chicago <- chicago_2011_to_2013.clean
levels(chicago$OFFENSE) <- c("ARSON","ASSAULT","ASSAULT","BURGLARY","SEX ABUSE","HOMICIDE","MOTOR VEHICLE THEFT","ROBBERY","SEX ABUSE","THEFT")
offense.chicago <- chicago %>%
select(OFFENSE) %>%
count(OFFENSE, sort = T) %>%
mutate(offense.percent = round((n / nrow(chicago)*100),1))
joined.offense <- left_join(offense.chicago,offense.washington,by = "OFFENSE") %>%
rename(n.chicago = n.x, n.washington = n.y, chicago = offense.percent.x, washington = offense.percent.y)
joined.offense.m <- melt(joined.offense,id.vars=c("OFFENSE","n.chicago","n.washington")) %>%
arrange(desc(value))
offense.barplot <- qplot(x=OFFENSE, y=value, fill=variable,
data=joined.offense.m, geom="bar", stat="identity",
position="dodge",ylab="%",main="Crime in cities of Chicago and Washington DC: Offense type")
offense.barplot
washingtonDC_2013$YEAR <- 2013
washingtonDC_2012$YEAR <- 2012
washingtonDC_2011$YEAR <- 2011
head(washingtonDC_2011$YEAR )
offense.chicago
offense.washington
str(offense.chicago$OFFENSE)
str(offense.washington$OFFENSE)
names(washingtonDC_2013)
summary(washingtonDC_2013)
names(washingtonDC_2013)
names(chicago_2013.clean)
washingtonDC_2013a <- read_csv("crime_incidents_2013_CSV.csv")
problems(crime_incidents_2013_CSV.csv)
>problems
?problems
problems(washingtonDC_2013a)
head(washingtonDC_2013a)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
head(washingtonDC_2013)
head(washingtonDC_2012)
tail(washingtonDC_2012)
install.packages("jsonlite")
library(jsonlite)
chicago <- fromJSON("https://data.cityofchicago.org/resource/6zsd-86xi.json")
head(chicago)
chicago_2013 <- fromJSON("https://data.cityofchicago.org/resource/6zsd-86xi.json?year=2013")
head(chicago_2013)
tail(chicago_2013)
tail(washingtonDC_2013)
washingtonDC_2013$REPORTDATETIME <- ymd_hms(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013$REPORTDATETIME <- ymd_hms(washingtonDC_2013$REPORTDATETIME)
head(washingtonDC_2013)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
head(washingtonDC_2013)
washingtonDC_2013$REPORTDATETIME <- ymd_hms(washingtonDC_2013$REPORTDATETIME)
head(washingtonDC_2013)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
head(washingtonDC_2013)
is_na(washingtonDC_2013)
na_data <- sapply(washingtonDC_2013, function(x) {sum(is.na(x))})
table(na_data)
sum(is.na(washingtonDC_2013$REPORTDATETIME))
summary(washingtonDC_2013$REPORTDATETIME)
str(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013$REPORTDATETIME <- strptime(washingtonDC_2013$REPORTDATETIME, "%a %b %d %H:%M:%S %Y")
head(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
head(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013$datetime <- strptime(washingtonDC_2013$REPORTDATETIME, "%m/%d/%y %H:%M:%S")
head(washingtonDC_2013$datetime)
library(lubridate)
washingtonDC_2013$datetime <- ymd_hms(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
washingtonDC_2013$datetime <- ymd_hms(washingtonDC_2013$REPORTDATETIME)
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
chicago_2013 <- fromJSON("https://data.cityofchicago.org/resource/6zsd-86xi.json?year=2013")
washingtonDC_2013$YEAR <- 2013
washingtonDC_2013$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2013$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2013$METHOD <- factor(washingtonDC_2013$METHOD)
washingtonDC_2012$SHIFT <- factor(washingtonDC_2012$SHIFT)
washingtonDC_2012$OFFENSE <- factor(washingtonDC_2012$OFFENSE)
washingtonDC_2012$METHOD <- factor(washingtonDC_2012$METHOD)
washingtonDC_2011$SHIFT <- factor(washingtonDC_2011$SHIFT)
washingtonDC_2011$OFFENSE <- factor(washingtonDC_2011$OFFENSE)
washingtonDC_2011$METHOD <- factor(washingtonDC_2011$METHOD)
chicago_2013$`Primary Type` <- factor(chicago_2013$`Primary Type`)
chicago_2013$Arrest <- factor(chicago_2013$Arrest)
chicago_2013$Domestic <- factor(chicago_2013$Domestic)
chicago_2011_to_2013$`Primary Type` <- factor(chicago_2013$`Primary Type`)
chicago_2011_to_2013$Arrest <- factor(chicago_2013$Arrest)
chicago_2011_to_2013$Domestic <- factor(chicago_2013$Domestic)
# factorize
washingtonDC_2013$SHIFT <- factor(washingtonDC_2013$SHIFT)
washingtonDC_2013$OFFENSE <- factor(washingtonDC_2013$OFFENSE)
washingtonDC_2013$METHOD <- factor(washingtonDC_2013$METHOD)
# washingtonDC_2012$SHIFT <- factor(washingtonDC_2012$SHIFT)
# washingtonDC_2012$OFFENSE <- factor(washingtonDC_2012$OFFENSE)
# washingtonDC_2012$METHOD <- factor(washingtonDC_2012$METHOD)
# washingtonDC_2011$SHIFT <- factor(washingtonDC_2011$SHIFT)
# washingtonDC_2011$OFFENSE <- factor(washingtonDC_2011$OFFENSE)
# washingtonDC_2011$METHOD <- factor(washingtonDC_2011$METHOD)
chicago_2013$`Primary Type` <- factor(chicago_2013$`Primary Type`)
chicago_2013$Arrest <- factor(chicago_2013$Arrest)
chicago_2013$Domestic <- factor(chicago_2013$Domestic)
head(chicago_2013)
chicago_2013$primary_type <- factor(chicago_2013$`Primary Type`)
chicago_2013$arrest <- factor(chicago_2013$Arrest)
chicago_2013$domestic <- factor(chicago_2013$Domestic)
chicago_2013$primary_type <- factor(chicago_2013$primary_type)
chicago_2013$arrest <- factor(chicago_2013$arrest)
chicago_2013$domestic <- factor(chicago_2013$domestic)
str(chicago_2013$primary_type)
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON" |
primary_type == "ASSAULT" |
primary_type == "BATTERY" |
primary_type == "BURGLARY" |
primary_type == "CRIM SEXUAL ASSAULT" |
primary_type == "HOMICIDE" |
primary_type == "MOTOR VEHICLE THEFT" |
primary_type == "ROBBERY" |
primary_type == "SEX OFFENSE" |
primary_type == "THEFT") %>%
mutate(OFFENSE = factor(primary_type))
library(readr)
library(dplyr)
library(lubridate)
library(ggplot2)
library(reshape2)
library(jsonlite)
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON" |
primary_type == "ASSAULT" |
primary_type == "BATTERY" |
primary_type == "BURGLARY" |
primary_type == "CRIM SEXUAL ASSAULT" |
primary_type == "HOMICIDE" |
primary_type == "MOTOR VEHICLE THEFT" |
primary_type == "ROBBERY" |
primary_type == "SEX OFFENSE" |
primary_type == "THEFT") %>%
mutate(OFFENSE = factor(primary_type))
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON" |
primary_type == "ASSAULT" |
primary_type == "BATTERY" |
primary_type == "BURGLARY" |
primary_type == "CRIM SEXUAL ASSAULT" |
primary_type == "HOMICIDE" |
primary_type == "MOTOR VEHICLE THEFT" |
primary_type == "ROBBERY" |
primary_type == "SEX OFFENSE" |
primary_type == "THEFT")
chicago_2013.clean <- chicago_2013
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON"
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON")
head(chicago_2013$primary_type)
chicago_2013[primary_type == 'ARSON']
head(chicago_2013)
chicago_2013 <- fromJSON("https://data.cityofchicago.org/resource/6zsd-86xi.json?year=2013")
chicago_2013.clean <- chicago_2013 %>%
filter(primary_type == "ARSON" |
primary_type == "ASSAULT" |
primary_type == "BATTERY" |
primary_type == "BURGLARY" |
primary_type == "CRIM SEXUAL ASSAULT" |
primary_type == "HOMICIDE" |
primary_type == "MOTOR VEHICLE THEFT" |
primary_type == "ROBBERY" |
primary_type == "SEX OFFENSE" |
primary_type == "THEFT") %>%
mutate(OFFENSE = factor(primary_type))
head(chicago_2013)
chicago <- read_csv("crime_chicago.csv")
setwd("~/Documents/datascience/dataincubator/crime_compare")
library(readr)
library(dplyr)
library(lubridate)
library(ggplot2)
library(reshape2)
# glimpse(washingtonDC_2013)
# glimpse(chicago)
# glimpse(chicago_2013)
# glimpse(chicago_2013.clean)
# levels(chicago_2013$`Primary Type`)
# levels(chicago_2013.clean$Offense)
# levels(washingtonDC_2013$OFFENSE)
# table(chicago_2013$`Primary Type`)
# table(washingtonDC_2013$OFFENSE)
# table(washingtonDC_2013$METHOD)
# table(chicago_2013.clean$Offense)
# reading data bases
washingtonDC_2013 <- read_csv("crime_washingtonDC_2013.csv")
chicago <- read_csv("crime_chicago.csv")
washingtonDC_2013 <- read_csv("crime_incidents_2013_CSV.csv")
chicago <- read_csv("crime_chicago.csv")
glimpse(washingtonDC_2013)
glimpse(chicago)
table(chicago_2013$`Primary Type`)
table(washingtonDC_2013$OFFENSE)
levels(chicago_2013$`Primary Type`)
chicago_2013 <- chicago %>%
mutate(Year = year(Date)) %>%
filter(Year == 2013)
washingtonDC_2013$LASTMODIFIEDDATE <- mdy_hms(washingtonDC_2013$LASTMODIFIEDDATE)
